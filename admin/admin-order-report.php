<?php
//! PHP TO GET CURRENT ORDERS AND PAST ORDERS
// Start the session to access idpelanggan
session_start();

include_once(__DIR__ . '/../connect.php');
$conn = getConnection();

//! PHP TO CHECK IF USER exists in db and logged in
if (!isset($_SESSION['idjurujual'])) {
  //? The user does not exists in db and not logged in!
  echo '<script>alert("Sila Log masuk/Daftar!");
                window.location.href = "../signup.php";
        </script>';
  exit();
} else {
  $idjurujual = $_SESSION['idjurujual'];

  $query = "SELECT idjurujual FROM jurujual WHERE idjurujual = ?";
  $stmt = $conn->prepare($query);
  $stmt->bind_param("s", $idjurujual);
  $stmt->execute();
  $stmt->store_result();

  if ($stmt->num_rows > 0) {
    //? The user exists in db and logged in!
  } else {
    //? The user does not exists in db!
    echo '<script>alert("Sila Log masuk/Daftar!");
                window.location.href = "../signup.php";
        </script>';
  }

  // Close the statement
  $stmt->close();
}

// Default messages
$current_orders_content = '<div class="no-order-display">
            <div class="no-order-image-container">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="328"
                height="299"
                viewBox="0 0 328 299"
                fill="none"
                style="height: auto; max-width: 100%"
              >
                <g clip-path="url(#clip0)">
                  <path
                    d="M198.527 16.7764L27.6426 51.8848L78.3027 277.963L249.187 242.855L198.527 16.7764Z"
                    fill="#E0E0E0"
                  ></path>
                  <g opacity="0.5">
                    <path
                      opacity="0.5"
                      d="M196.498 21.1915L31.3889 55.1133L80.3366 273.55L245.446 239.628L196.498 21.1915Z"
                      fill="url(#paint0_linear)"
                    ></path>
                  </g>
                  <path
                    d="M194.754 23.2309L33.8488 56.2891L81.715 269.9L242.621 236.842L194.754 23.2309Z"
                    fill="#FAFAFA"
                  ></path>
                  <path
                    d="M152.349 22.2565L72.5258 38.6562L76.6747 57.171L156.498 40.7713L152.349 22.2565Z"
                    fill="url(#paint1_linear)"
                  ></path>
                  <path
                    d="M108.383 12.373C102.22 13.6405 98.3208 19.5645 99.6765 25.6034C101.032 31.6423 107.123 35.5176 113.274 34.2501C119.425 32.9826 123.336 27.0586 121.98 21.0197C120.624 14.9808 114.546 11.1055 108.383 12.373ZM112.25 29.6434C110.948 29.9408 109.582 29.8602 108.328 29.4118C107.073 28.9633 105.987 28.1674 105.206 27.1255C104.426 26.0835 103.987 24.8427 103.946 23.5612C103.905 22.2796 104.264 21.0154 104.976 19.9296C105.688 18.8438 106.722 17.9857 107.945 17.4645C109.168 16.9433 110.526 16.7826 111.845 17.0031C113.164 17.2235 114.385 17.815 115.352 18.7022C116.318 19.5894 116.987 20.7321 117.273 21.9847C117.471 22.8035 117.497 23.6516 117.352 24.4802C117.206 25.3089 116.89 26.1019 116.424 26.8135C115.957 27.5252 115.348 28.1415 114.632 28.6272C113.915 29.1128 113.106 29.4582 112.25 29.6434Z"
                    fill="url(#paint2_linear)"
                  ></path>
                  <path
                    d="M151.33 21.6352L73.1885 37.6895L77.1545 55.388L155.296 39.3337L151.33 21.6352Z"
                    fill="#c28a84"
                  ></path>
                  <path
                    d="M108.383 12.3729C106.223 12.8168 104.249 13.864 102.711 15.3821C101.172 16.9002 100.138 18.821 99.7402 20.9017C99.3418 22.9823 99.5968 25.1293 100.473 27.0712C101.349 29.0131 102.806 30.6626 104.661 31.8113C106.517 32.9599 108.686 33.5561 110.895 33.5243C113.103 33.4926 115.253 32.8344 117.071 31.633C118.889 30.4316 120.295 28.7409 121.109 26.7747C121.924 24.8085 122.112 22.6551 121.648 20.5869C121.341 19.2135 120.753 17.9116 119.92 16.7555C119.087 15.5994 118.024 14.6118 116.792 13.849C115.561 13.0863 114.184 12.5633 112.741 12.3101C111.298 12.0568 109.817 12.0782 108.383 12.3729ZM112.078 28.8774C110.831 29.1336 109.533 29.03 108.348 28.5797C107.163 28.1294 106.144 27.3527 105.42 26.3478C104.695 25.3429 104.299 24.1549 104.28 22.9341C104.261 21.7133 104.62 20.5145 105.313 19.4894C106.005 18.4642 107 17.6587 108.17 17.1747C109.341 16.6907 110.635 16.55 111.889 16.7704C113.143 16.9907 114.301 17.5623 115.216 18.4127C116.131 19.2631 116.762 20.3542 117.029 21.5481C117.388 23.1486 117.067 24.82 116.139 26.1945C115.21 27.5689 113.75 28.534 112.078 28.8774Z"
                    fill="#c28a84"
                  ></path>
                  <path
                    d="M277.91 44.7695H103.136V275.994H277.91V44.7695Z"
                    fill="#E0E0E0"
                  ></path>
                  <g opacity="0.5">
                    <path
                      opacity="0.5"
                      d="M274.958 48.6777H106.091V272.086H274.958V48.6777Z"
                      fill="url(#paint3_linear)"
                    ></path>
                  </g>
                  <path
                    d="M272.807 50.3262H108.239V268.799H272.807V50.3262Z"
                    fill="white"
                  ></path>
                  <path
                    d="M231.559 40.8516H149.919V59.7878H231.559V40.8516Z"
                    fill="url(#paint4_linear)"
                  ></path>
                  <path
                    d="M190.739 22.3672C184.436 22.3672 179.325 27.376 179.325 33.5566C179.325 39.7372 184.436 44.746 190.739 44.746C197.042 44.746 202.153 39.7372 202.153 33.5566C202.153 27.376 197.042 22.3672 190.739 22.3672ZM190.739 40.0129C189.399 40.0433 188.08 39.6907 186.95 39C185.82 38.3094 184.931 37.312 184.396 36.1353C183.862 34.9585 183.705 33.6559 183.947 32.3935C184.189 31.1312 184.818 29.9665 185.754 29.0482C186.69 28.1299 187.891 27.4996 189.203 27.2378C190.516 26.9761 191.879 27.0946 193.121 27.5785C194.362 28.0623 195.425 28.8894 196.173 29.9542C196.921 31.019 197.321 32.2732 197.321 33.5566C197.334 35.2433 196.649 36.8663 195.415 38.0705C194.182 39.2747 192.5 39.962 190.739 39.9822V40.0129Z"
                    fill="url(#paint5_linear)"
                  ></path>
                  <path
                    d="M230.699 40.0391H150.779V58.1404H230.699V40.0391Z"
                    fill="#c28a84"
                  ></path>
                  <path
                    d="M190.739 22.3672C188.53 22.3672 186.37 22.9945 184.533 24.1697C182.696 25.3449 181.265 27.0153 180.419 28.9696C179.574 30.924 179.353 33.0744 179.784 35.1491C180.215 37.2239 181.278 39.1296 182.841 40.6254C184.403 42.1211 186.393 43.1398 188.56 43.5525C190.726 43.9651 192.972 43.7533 195.013 42.9438C197.054 42.1343 198.799 40.7635 200.026 39.0046C201.253 37.2458 201.909 35.1779 201.909 33.0626C201.909 30.226 200.732 27.5056 198.637 25.4998C196.542 23.494 193.701 22.3672 190.739 22.3672ZM190.739 39.2355C189.465 39.234 188.22 38.871 187.161 38.1925C186.102 37.514 185.277 36.5503 184.79 35.4231C184.303 34.2959 184.175 33.0557 184.424 31.8592C184.672 30.6627 185.285 29.5635 186.185 28.7004C187.086 27.8372 188.233 27.2489 189.482 27.0096C190.731 26.7703 192.027 26.8908 193.205 27.3559C194.382 27.821 195.39 28.6098 196.1 29.6227C196.81 30.6357 197.19 31.8274 197.193 33.0473C197.193 33.8582 197.026 34.6611 196.701 35.4101C196.376 36.1591 195.9 36.8395 195.301 37.4124C194.702 37.9853 193.99 38.4395 193.207 38.749C192.425 39.0586 191.586 39.2174 190.739 39.2164V39.2355Z"
                    fill="#c28a84"
                  ></path>
                  <g opacity="0.5">
                    <path
                      opacity="0.5"
                      d="M7.61056 282.242H6.10686V290.41H7.61056V282.242Z"
                      fill="#47E6B1"
                    ></path>
                    <path
                      opacity="0.5"
                      d="M11.1259 287.049V285.609H2.59554V287.049H11.1259Z"
                      fill="#47E6B1"
                    ></path>
                  </g>
                  <g opacity="0.5">
                    <path
                      opacity="0.5"
                      d="M182.064 0H180.561V8.16802H182.064V0Z"
                      fill="#47E6B1"
                    ></path>
                    <path
                      opacity="0.5"
                      d="M185.58 4.80115V3.36133L177.049 3.36133V4.80115H185.58Z"
                      fill="#47E6B1"
                    ></path>
                  </g>
                  <path
                    opacity="0.5"
                    d="M308.372 295.84C307.957 295.667 307.623 295.355 307.434 294.961C307.244 294.568 307.212 294.122 307.344 293.707C307.365 293.644 307.379 293.578 307.384 293.512C307.396 293.322 307.344 293.134 307.235 292.975C307.127 292.816 306.968 292.695 306.781 292.629C306.595 292.563 306.392 292.557 306.201 292.61C306.011 292.664 305.844 292.774 305.724 292.926C305.683 292.979 305.648 293.037 305.62 293.098C305.44 293.496 305.113 293.815 304.702 293.997C304.292 294.178 303.825 294.209 303.393 294.083C303.327 294.062 303.258 294.049 303.189 294.044C302.991 294.033 302.794 294.083 302.628 294.187C302.462 294.291 302.335 294.443 302.266 294.621C302.198 294.8 302.191 294.994 302.247 295.177C302.303 295.359 302.419 295.519 302.577 295.633C302.633 295.673 302.693 295.707 302.757 295.733C303.172 295.906 303.506 296.219 303.695 296.612C303.885 297.005 303.916 297.452 303.785 297.866C303.763 297.929 303.75 297.995 303.745 298.061C303.733 298.251 303.785 298.439 303.893 298.598C304.002 298.757 304.161 298.879 304.347 298.944C304.533 299.01 304.737 299.017 304.927 298.963C305.118 298.91 305.285 298.799 305.404 298.647C305.446 298.594 305.481 298.536 305.508 298.475C305.689 298.078 306.016 297.758 306.426 297.577C306.837 297.395 307.303 297.365 307.736 297.491C307.802 297.511 307.871 297.524 307.94 297.529C308.138 297.54 308.335 297.49 308.501 297.387C308.667 297.283 308.794 297.13 308.862 296.952C308.931 296.774 308.938 296.579 308.882 296.397C308.826 296.214 308.71 296.054 308.552 295.94C308.496 295.9 308.436 295.867 308.372 295.84Z"
                    fill="#4D8AF0"
                  ></path>
                  <path
                    opacity="0.5"
                    d="M54.6574 217.317C54.2426 217.144 53.9087 216.831 53.7192 216.438C53.5297 216.045 53.4978 215.598 53.6296 215.184C53.6508 215.121 53.6643 215.055 53.6695 214.989C53.6815 214.799 53.6293 214.611 53.5208 214.452C53.4123 214.293 53.2531 214.171 53.067 214.105C52.8808 214.04 52.6775 214.033 52.4871 214.087C52.2967 214.14 52.1294 214.251 52.0099 214.403C51.9683 214.456 51.9334 214.514 51.9059 214.575C51.7253 214.972 51.3986 215.292 50.9879 215.473C50.5771 215.655 50.1111 215.685 49.6783 215.559C49.6121 215.539 49.5437 215.526 49.4744 215.521C49.2763 215.509 49.0797 215.559 48.9135 215.663C48.7474 215.767 48.6207 215.92 48.552 216.098C48.4834 216.276 48.4765 216.471 48.5324 216.653C48.5883 216.835 48.7041 216.996 48.8625 217.11C48.9182 217.15 48.9786 217.183 49.0424 217.21C49.4572 217.383 49.7911 217.695 49.9806 218.089C50.1701 218.482 50.202 218.928 50.0703 219.343C50.049 219.406 50.0356 219.472 50.0303 219.538C50.0183 219.728 50.0705 219.916 50.179 220.075C50.2875 220.234 50.4467 220.355 50.6328 220.421C50.819 220.487 51.0224 220.493 51.2127 220.44C51.4031 220.386 51.5705 220.275 51.6899 220.124C51.7315 220.07 51.7664 220.013 51.7939 219.951C51.9745 219.554 52.3012 219.235 52.7119 219.053C53.1227 218.872 53.5888 218.841 54.0215 218.967C54.0877 218.988 54.1561 219.001 54.2254 219.006C54.4235 219.017 54.6202 218.967 54.7863 218.863C54.9524 218.759 55.0792 218.607 55.1478 218.429C55.2164 218.25 55.2233 218.056 55.1674 217.873C55.1115 217.691 54.9957 217.531 54.8373 217.416C54.7816 217.377 54.7212 217.343 54.6574 217.317Z"
                    fill="#FDD835"
                  ></path>
                  <path
                    opacity="0.5"
                    d="M265.98 26.1078C265.565 25.935 265.231 25.6221 265.042 25.2288C264.852 24.8355 264.821 24.3892 264.952 23.9749C264.974 23.9115 264.987 23.846 264.992 23.7796C265.004 23.5899 264.952 23.4016 264.844 23.2426C264.735 23.0835 264.576 22.9621 264.39 22.8964C264.204 22.8307 264 22.8241 263.81 22.8776C263.619 22.9312 263.452 23.042 263.333 23.1937C263.291 23.247 263.256 23.3049 263.229 23.366C263.048 23.7632 262.721 24.0829 262.311 24.2643C261.9 24.4458 261.434 24.4763 261.001 24.3502C260.935 24.3298 260.866 24.3169 260.797 24.3119C260.599 24.3004 260.402 24.3504 260.236 24.4543C260.07 24.5582 259.943 24.7106 259.875 24.8889C259.806 25.0671 259.799 25.2618 259.855 25.4441C259.911 25.6264 260.027 25.7866 260.185 25.901C260.241 25.9409 260.301 25.9743 260.365 26.0006C260.78 26.1735 261.114 26.4863 261.303 26.8796C261.493 27.2729 261.525 27.7192 261.393 28.1336C261.372 28.1969 261.358 28.2625 261.353 28.3289C261.341 28.5185 261.393 28.7068 261.502 28.8659C261.61 29.0249 261.769 29.1463 261.956 29.212C262.142 29.2778 262.345 29.2843 262.535 29.2308C262.726 29.1773 262.893 29.0664 263.013 28.9148C263.054 28.8614 263.089 28.8036 263.117 28.7424C263.297 28.3453 263.624 28.0256 264.035 27.8441C264.445 27.6626 264.912 27.6321 265.344 27.7583C265.41 27.7787 265.479 27.7915 265.548 27.7966C265.746 27.808 265.943 27.7581 266.109 27.6541C266.275 27.5502 266.402 27.3979 266.471 27.2196C266.539 27.0413 266.546 26.8466 266.49 26.6643C266.434 26.482 266.319 26.3218 266.16 26.2074C266.104 26.1676 266.044 26.1342 265.98 26.1078Z"
                    fill="#FDD835"
                  ></path>
                  <path
                    opacity="0.5"
                    d="M324.993 123.304C326.656 123.304 328.004 122.013 328.004 120.421C328.004 118.828 326.656 117.537 324.993 117.537C323.329 117.537 321.981 118.828 321.981 120.421C321.981 122.013 323.329 123.304 324.993 123.304Z"
                    fill="#F55F44"
                  ></path>
                  <path
                    opacity="0.5"
                    d="M92.274 288.802C93.9371 288.802 95.2854 287.511 95.2854 285.919C95.2854 284.326 93.9371 283.035 92.274 283.035C90.6108 283.035 89.2626 284.326 89.2626 285.919C89.2626 287.511 90.6108 288.802 92.274 288.802Z"
                    fill="#F55F44"
                  ></path>
                  <path
                    opacity="0.5"
                    d="M294.067 185.632C295.73 185.632 297.078 184.341 297.078 182.749C297.078 181.156 295.73 179.865 294.067 179.865C292.403 179.865 291.055 181.156 291.055 182.749C291.055 184.341 292.403 185.632 294.067 185.632Z"
                    fill="#F55F44"
                  ></path>
                  <path
                    opacity="0.5"
                    d="M34.8492 39.7787C36.5124 39.7787 37.8606 38.4877 37.8606 36.8952C37.8606 35.3027 36.5124 34.0117 34.8492 34.0117C33.1861 34.0117 31.8378 35.3027 31.8378 36.8952C31.8378 38.4877 33.1861 39.7787 34.8492 39.7787Z"
                    fill="#4D8AF0"
                  ></path>
                  <path
                    opacity="0.5"
                    d="M3.01141 118.439C4.67457 118.439 6.02282 117.148 6.02282 115.555C6.02282 113.963 4.67457 112.672 3.01141 112.672C1.34825 112.672 0 113.963 0 115.555C0 117.148 1.34825 118.439 3.01141 118.439Z"
                    fill="#47E6B1"
                  ></path>
                </g>
                <defs>
                  <linearGradient
                    id="paint0_linear"
                    x1="162.889"
                    y1="256.59"
                    x2="117.846"
                    y2="37.3505"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#808080" stop-opacity="0.25"></stop>
                    <stop
                      offset="0.54"
                      stop-color="#808080"
                      stop-opacity="0.12"
                    ></stop>
                    <stop
                      offset="1"
                      stop-color="#808080"
                      stop-opacity="0.1"
                    ></stop>
                  </linearGradient>
                  <linearGradient
                    id="paint1_linear"
                    x1="43914"
                    y1="-5475.56"
                    x2="43725.2"
                    y2="-6394.48"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#808080" stop-opacity="0.25"></stop>
                    <stop
                      offset="0.54"
                      stop-color="#808080"
                      stop-opacity="0.12"
                    ></stop>
                    <stop
                      offset="1"
                      stop-color="#808080"
                      stop-opacity="0.1"
                    ></stop>
                  </linearGradient>
                  <linearGradient
                    id="paint2_linear"
                    x1="12823"
                    y1="624.556"
                    x2="12559.6"
                    y2="-657.413"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#808080" stop-opacity="0.25"></stop>
                    <stop
                      offset="0.54"
                      stop-color="#808080"
                      stop-opacity="0.12"
                    ></stop>
                    <stop
                      offset="1"
                      stop-color="#808080"
                      stop-opacity="0.1"
                    ></stop>
                  </linearGradient>
                  <linearGradient
                    id="paint3_linear"
                    x1="80554.3"
                    y1="158787"
                    x2="80554.3"
                    y2="28448.4"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#808080" stop-opacity="0.25"></stop>
                    <stop
                      offset="0.54"
                      stop-color="#808080"
                      stop-opacity="0.12"
                    ></stop>
                    <stop
                      offset="1"
                      stop-color="#808080"
                      stop-opacity="0.1"
                    ></stop>
                  </linearGradient>
                  <linearGradient
                    id="paint4_linear"
                    x1="39087.3"
                    y1="2997.36"
                    x2="39087.3"
                    y2="2060.96"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#808080" stop-opacity="0.25"></stop>
                    <stop
                      offset="0.54"
                      stop-color="#808080"
                      stop-opacity="0.12"
                    ></stop>
                    <stop
                      offset="1"
                      stop-color="#808080"
                      stop-opacity="0.1"
                    ></stop>
                  </linearGradient>
                  <linearGradient
                    id="paint5_linear"
                    x1="15402.1"
                    y1="3969.76"
                    x2="15402.1"
                    y2="2661.94"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#808080" stop-opacity="0.25"></stop>
                    <stop
                      offset="0.54"
                      stop-color="#808080"
                      stop-opacity="0.12"
                    ></stop>
                    <stop
                      offset="1"
                      stop-color="#808080"
                      stop-opacity="0.1"
                    ></stop>
                  </linearGradient>
                  <clipPath id="clip0">
                    <rect width="328" height="299" fill="white"></rect>
                  </clipPath>
                </defs>
              </svg>
            </div>
            <p>Tiada Pesanan Semasa</p>
          </div>';
$past_orders_content = '<div class="no-order-display">
            <div class="no-order-image-container">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="328"
                height="299"
                viewBox="0 0 328 299"
                fill="none"
                style="height: auto; max-width: 100%"
              >
                <g clip-path="url(#clip0)">
                  <path
                    d="M198.527 16.7764L27.6426 51.8848L78.3027 277.963L249.187 242.855L198.527 16.7764Z"
                    fill="#E0E0E0"
                  ></path>
                  <g opacity="0.5">
                    <path
                      opacity="0.5"
                      d="M196.498 21.1915L31.3889 55.1133L80.3366 273.55L245.446 239.628L196.498 21.1915Z"
                      fill="url(#paint0_linear)"
                    ></path>
                  </g>
                  <path
                    d="M194.754 23.2309L33.8488 56.2891L81.715 269.9L242.621 236.842L194.754 23.2309Z"
                    fill="#FAFAFA"
                  ></path>
                  <path
                    d="M152.349 22.2565L72.5258 38.6562L76.6747 57.171L156.498 40.7713L152.349 22.2565Z"
                    fill="url(#paint1_linear)"
                  ></path>
                  <path
                    d="M108.383 12.373C102.22 13.6405 98.3208 19.5645 99.6765 25.6034C101.032 31.6423 107.123 35.5176 113.274 34.2501C119.425 32.9826 123.336 27.0586 121.98 21.0197C120.624 14.9808 114.546 11.1055 108.383 12.373ZM112.25 29.6434C110.948 29.9408 109.582 29.8602 108.328 29.4118C107.073 28.9633 105.987 28.1674 105.206 27.1255C104.426 26.0835 103.987 24.8427 103.946 23.5612C103.905 22.2796 104.264 21.0154 104.976 19.9296C105.688 18.8438 106.722 17.9857 107.945 17.4645C109.168 16.9433 110.526 16.7826 111.845 17.0031C113.164 17.2235 114.385 17.815 115.352 18.7022C116.318 19.5894 116.987 20.7321 117.273 21.9847C117.471 22.8035 117.497 23.6516 117.352 24.4802C117.206 25.3089 116.89 26.1019 116.424 26.8135C115.957 27.5252 115.348 28.1415 114.632 28.6272C113.915 29.1128 113.106 29.4582 112.25 29.6434Z"
                    fill="url(#paint2_linear)"
                  ></path>
                  <path
                    d="M151.33 21.6352L73.1885 37.6895L77.1545 55.388L155.296 39.3337L151.33 21.6352Z"
                    fill="#c28a84"
                  ></path>
                  <path
                    d="M108.383 12.3729C106.223 12.8168 104.249 13.864 102.711 15.3821C101.172 16.9002 100.138 18.821 99.7402 20.9017C99.3418 22.9823 99.5968 25.1293 100.473 27.0712C101.349 29.0131 102.806 30.6626 104.661 31.8113C106.517 32.9599 108.686 33.5561 110.895 33.5243C113.103 33.4926 115.253 32.8344 117.071 31.633C118.889 30.4316 120.295 28.7409 121.109 26.7747C121.924 24.8085 122.112 22.6551 121.648 20.5869C121.341 19.2135 120.753 17.9116 119.92 16.7555C119.087 15.5994 118.024 14.6118 116.792 13.849C115.561 13.0863 114.184 12.5633 112.741 12.3101C111.298 12.0568 109.817 12.0782 108.383 12.3729ZM112.078 28.8774C110.831 29.1336 109.533 29.03 108.348 28.5797C107.163 28.1294 106.144 27.3527 105.42 26.3478C104.695 25.3429 104.299 24.1549 104.28 22.9341C104.261 21.7133 104.62 20.5145 105.313 19.4894C106.005 18.4642 107 17.6587 108.17 17.1747C109.341 16.6907 110.635 16.55 111.889 16.7704C113.143 16.9907 114.301 17.5623 115.216 18.4127C116.131 19.2631 116.762 20.3542 117.029 21.5481C117.388 23.1486 117.067 24.82 116.139 26.1945C115.21 27.5689 113.75 28.534 112.078 28.8774Z"
                    fill="#c28a84"
                  ></path>
                  <path
                    d="M277.91 44.7695H103.136V275.994H277.91V44.7695Z"
                    fill="#E0E0E0"
                  ></path>
                  <g opacity="0.5">
                    <path
                      opacity="0.5"
                      d="M274.958 48.6777H106.091V272.086H274.958V48.6777Z"
                      fill="url(#paint3_linear)"
                    ></path>
                  </g>
                  <path
                    d="M272.807 50.3262H108.239V268.799H272.807V50.3262Z"
                    fill="white"
                  ></path>
                  <path
                    d="M231.559 40.8516H149.919V59.7878H231.559V40.8516Z"
                    fill="url(#paint4_linear)"
                  ></path>
                  <path
                    d="M190.739 22.3672C184.436 22.3672 179.325 27.376 179.325 33.5566C179.325 39.7372 184.436 44.746 190.739 44.746C197.042 44.746 202.153 39.7372 202.153 33.5566C202.153 27.376 197.042 22.3672 190.739 22.3672ZM190.739 40.0129C189.399 40.0433 188.08 39.6907 186.95 39C185.82 38.3094 184.931 37.312 184.396 36.1353C183.862 34.9585 183.705 33.6559 183.947 32.3935C184.189 31.1312 184.818 29.9665 185.754 29.0482C186.69 28.1299 187.891 27.4996 189.203 27.2378C190.516 26.9761 191.879 27.0946 193.121 27.5785C194.362 28.0623 195.425 28.8894 196.173 29.9542C196.921 31.019 197.321 32.2732 197.321 33.5566C197.334 35.2433 196.649 36.8663 195.415 38.0705C194.182 39.2747 192.5 39.962 190.739 39.9822V40.0129Z"
                    fill="url(#paint5_linear)"
                  ></path>
                  <path
                    d="M230.699 40.0391H150.779V58.1404H230.699V40.0391Z"
                    fill="#c28a84"
                  ></path>
                  <path
                    d="M190.739 22.3672C188.53 22.3672 186.37 22.9945 184.533 24.1697C182.696 25.3449 181.265 27.0153 180.419 28.9696C179.574 30.924 179.353 33.0744 179.784 35.1491C180.215 37.2239 181.278 39.1296 182.841 40.6254C184.403 42.1211 186.393 43.1398 188.56 43.5525C190.726 43.9651 192.972 43.7533 195.013 42.9438C197.054 42.1343 198.799 40.7635 200.026 39.0046C201.253 37.2458 201.909 35.1779 201.909 33.0626C201.909 30.226 200.732 27.5056 198.637 25.4998C196.542 23.494 193.701 22.3672 190.739 22.3672ZM190.739 39.2355C189.465 39.234 188.22 38.871 187.161 38.1925C186.102 37.514 185.277 36.5503 184.79 35.4231C184.303 34.2959 184.175 33.0557 184.424 31.8592C184.672 30.6627 185.285 29.5635 186.185 28.7004C187.086 27.8372 188.233 27.2489 189.482 27.0096C190.731 26.7703 192.027 26.8908 193.205 27.3559C194.382 27.821 195.39 28.6098 196.1 29.6227C196.81 30.6357 197.19 31.8274 197.193 33.0473C197.193 33.8582 197.026 34.6611 196.701 35.4101C196.376 36.1591 195.9 36.8395 195.301 37.4124C194.702 37.9853 193.99 38.4395 193.207 38.749C192.425 39.0586 191.586 39.2174 190.739 39.2164V39.2355Z"
                    fill="#c28a84"
                  ></path>
                  <g opacity="0.5">
                    <path
                      opacity="0.5"
                      d="M7.61056 282.242H6.10686V290.41H7.61056V282.242Z"
                      fill="#47E6B1"
                    ></path>
                    <path
                      opacity="0.5"
                      d="M11.1259 287.049V285.609H2.59554V287.049H11.1259Z"
                      fill="#47E6B1"
                    ></path>
                  </g>
                  <g opacity="0.5">
                    <path
                      opacity="0.5"
                      d="M182.064 0H180.561V8.16802H182.064V0Z"
                      fill="#47E6B1"
                    ></path>
                    <path
                      opacity="0.5"
                      d="M185.58 4.80115V3.36133L177.049 3.36133V4.80115H185.58Z"
                      fill="#47E6B1"
                    ></path>
                  </g>
                  <path
                    opacity="0.5"
                    d="M308.372 295.84C307.957 295.667 307.623 295.355 307.434 294.961C307.244 294.568 307.212 294.122 307.344 293.707C307.365 293.644 307.379 293.578 307.384 293.512C307.396 293.322 307.344 293.134 307.235 292.975C307.127 292.816 306.968 292.695 306.781 292.629C306.595 292.563 306.392 292.557 306.201 292.61C306.011 292.664 305.844 292.774 305.724 292.926C305.683 292.979 305.648 293.037 305.62 293.098C305.44 293.496 305.113 293.815 304.702 293.997C304.292 294.178 303.825 294.209 303.393 294.083C303.327 294.062 303.258 294.049 303.189 294.044C302.991 294.033 302.794 294.083 302.628 294.187C302.462 294.291 302.335 294.443 302.266 294.621C302.198 294.8 302.191 294.994 302.247 295.177C302.303 295.359 302.419 295.519 302.577 295.633C302.633 295.673 302.693 295.707 302.757 295.733C303.172 295.906 303.506 296.219 303.695 296.612C303.885 297.005 303.916 297.452 303.785 297.866C303.763 297.929 303.75 297.995 303.745 298.061C303.733 298.251 303.785 298.439 303.893 298.598C304.002 298.757 304.161 298.879 304.347 298.944C304.533 299.01 304.737 299.017 304.927 298.963C305.118 298.91 305.285 298.799 305.404 298.647C305.446 298.594 305.481 298.536 305.508 298.475C305.689 298.078 306.016 297.758 306.426 297.577C306.837 297.395 307.303 297.365 307.736 297.491C307.802 297.511 307.871 297.524 307.94 297.529C308.138 297.54 308.335 297.49 308.501 297.387C308.667 297.283 308.794 297.13 308.862 296.952C308.931 296.774 308.938 296.579 308.882 296.397C308.826 296.214 308.71 296.054 308.552 295.94C308.496 295.9 308.436 295.867 308.372 295.84Z"
                    fill="#4D8AF0"
                  ></path>
                  <path
                    opacity="0.5"
                    d="M54.6574 217.317C54.2426 217.144 53.9087 216.831 53.7192 216.438C53.5297 216.045 53.4978 215.598 53.6296 215.184C53.6508 215.121 53.6643 215.055 53.6695 214.989C53.6815 214.799 53.6293 214.611 53.5208 214.452C53.4123 214.293 53.2531 214.171 53.067 214.105C52.8808 214.04 52.6775 214.033 52.4871 214.087C52.2967 214.14 52.1294 214.251 52.0099 214.403C51.9683 214.456 51.9334 214.514 51.9059 214.575C51.7253 214.972 51.3986 215.292 50.9879 215.473C50.5771 215.655 50.1111 215.685 49.6783 215.559C49.6121 215.539 49.5437 215.526 49.4744 215.521C49.2763 215.509 49.0797 215.559 48.9135 215.663C48.7474 215.767 48.6207 215.92 48.552 216.098C48.4834 216.276 48.4765 216.471 48.5324 216.653C48.5883 216.835 48.7041 216.996 48.8625 217.11C48.9182 217.15 48.9786 217.183 49.0424 217.21C49.4572 217.383 49.7911 217.695 49.9806 218.089C50.1701 218.482 50.202 218.928 50.0703 219.343C50.049 219.406 50.0356 219.472 50.0303 219.538C50.0183 219.728 50.0705 219.916 50.179 220.075C50.2875 220.234 50.4467 220.355 50.6328 220.421C50.819 220.487 51.0224 220.493 51.2127 220.44C51.4031 220.386 51.5705 220.275 51.6899 220.124C51.7315 220.07 51.7664 220.013 51.7939 219.951C51.9745 219.554 52.3012 219.235 52.7119 219.053C53.1227 218.872 53.5888 218.841 54.0215 218.967C54.0877 218.988 54.1561 219.001 54.2254 219.006C54.4235 219.017 54.6202 218.967 54.7863 218.863C54.9524 218.759 55.0792 218.607 55.1478 218.429C55.2164 218.25 55.2233 218.056 55.1674 217.873C55.1115 217.691 54.9957 217.531 54.8373 217.416C54.7816 217.377 54.7212 217.343 54.6574 217.317Z"
                    fill="#FDD835"
                  ></path>
                  <path
                    opacity="0.5"
                    d="M265.98 26.1078C265.565 25.935 265.231 25.6221 265.042 25.2288C264.852 24.8355 264.821 24.3892 264.952 23.9749C264.974 23.9115 264.987 23.846 264.992 23.7796C265.004 23.5899 264.952 23.4016 264.844 23.2426C264.735 23.0835 264.576 22.9621 264.39 22.8964C264.204 22.8307 264 22.8241 263.81 22.8776C263.619 22.9312 263.452 23.042 263.333 23.1937C263.291 23.247 263.256 23.3049 263.229 23.366C263.048 23.7632 262.721 24.0829 262.311 24.2643C261.9 24.4458 261.434 24.4763 261.001 24.3502C260.935 24.3298 260.866 24.3169 260.797 24.3119C260.599 24.3004 260.402 24.3504 260.236 24.4543C260.07 24.5582 259.943 24.7106 259.875 24.8889C259.806 25.0671 259.799 25.2618 259.855 25.4441C259.911 25.6264 260.027 25.7866 260.185 25.901C260.241 25.9409 260.301 25.9743 260.365 26.0006C260.78 26.1735 261.114 26.4863 261.303 26.8796C261.493 27.2729 261.525 27.7192 261.393 28.1336C261.372 28.1969 261.358 28.2625 261.353 28.3289C261.341 28.5185 261.393 28.7068 261.502 28.8659C261.61 29.0249 261.769 29.1463 261.956 29.212C262.142 29.2778 262.345 29.2843 262.535 29.2308C262.726 29.1773 262.893 29.0664 263.013 28.9148C263.054 28.8614 263.089 28.8036 263.117 28.7424C263.297 28.3453 263.624 28.0256 264.035 27.8441C264.445 27.6626 264.912 27.6321 265.344 27.7583C265.41 27.7787 265.479 27.7915 265.548 27.7966C265.746 27.808 265.943 27.7581 266.109 27.6541C266.275 27.5502 266.402 27.3979 266.471 27.2196C266.539 27.0413 266.546 26.8466 266.49 26.6643C266.434 26.482 266.319 26.3218 266.16 26.2074C266.104 26.1676 266.044 26.1342 265.98 26.1078Z"
                    fill="#FDD835"
                  ></path>
                  <path
                    opacity="0.5"
                    d="M324.993 123.304C326.656 123.304 328.004 122.013 328.004 120.421C328.004 118.828 326.656 117.537 324.993 117.537C323.329 117.537 321.981 118.828 321.981 120.421C321.981 122.013 323.329 123.304 324.993 123.304Z"
                    fill="#F55F44"
                  ></path>
                  <path
                    opacity="0.5"
                    d="M92.274 288.802C93.9371 288.802 95.2854 287.511 95.2854 285.919C95.2854 284.326 93.9371 283.035 92.274 283.035C90.6108 283.035 89.2626 284.326 89.2626 285.919C89.2626 287.511 90.6108 288.802 92.274 288.802Z"
                    fill="#F55F44"
                  ></path>
                  <path
                    opacity="0.5"
                    d="M294.067 185.632C295.73 185.632 297.078 184.341 297.078 182.749C297.078 181.156 295.73 179.865 294.067 179.865C292.403 179.865 291.055 181.156 291.055 182.749C291.055 184.341 292.403 185.632 294.067 185.632Z"
                    fill="#F55F44"
                  ></path>
                  <path
                    opacity="0.5"
                    d="M34.8492 39.7787C36.5124 39.7787 37.8606 38.4877 37.8606 36.8952C37.8606 35.3027 36.5124 34.0117 34.8492 34.0117C33.1861 34.0117 31.8378 35.3027 31.8378 36.8952C31.8378 38.4877 33.1861 39.7787 34.8492 39.7787Z"
                    fill="#4D8AF0"
                  ></path>
                  <path
                    opacity="0.5"
                    d="M3.01141 118.439C4.67457 118.439 6.02282 117.148 6.02282 115.555C6.02282 113.963 4.67457 112.672 3.01141 112.672C1.34825 112.672 0 113.963 0 115.555C0 117.148 1.34825 118.439 3.01141 118.439Z"
                    fill="#47E6B1"
                  ></path>
                </g>
                <defs>
                  <linearGradient
                    id="paint0_linear"
                    x1="162.889"
                    y1="256.59"
                    x2="117.846"
                    y2="37.3505"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#808080" stop-opacity="0.25"></stop>
                    <stop
                      offset="0.54"
                      stop-color="#808080"
                      stop-opacity="0.12"
                    ></stop>
                    <stop
                      offset="1"
                      stop-color="#808080"
                      stop-opacity="0.1"
                    ></stop>
                  </linearGradient>
                  <linearGradient
                    id="paint1_linear"
                    x1="43914"
                    y1="-5475.56"
                    x2="43725.2"
                    y2="-6394.48"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#808080" stop-opacity="0.25"></stop>
                    <stop
                      offset="0.54"
                      stop-color="#808080"
                      stop-opacity="0.12"
                    ></stop>
                    <stop
                      offset="1"
                      stop-color="#808080"
                      stop-opacity="0.1"
                    ></stop>
                  </linearGradient>
                  <linearGradient
                    id="paint2_linear"
                    x1="12823"
                    y1="624.556"
                    x2="12559.6"
                    y2="-657.413"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#808080" stop-opacity="0.25"></stop>
                    <stop
                      offset="0.54"
                      stop-color="#808080"
                      stop-opacity="0.12"
                    ></stop>
                    <stop
                      offset="1"
                      stop-color="#808080"
                      stop-opacity="0.1"
                    ></stop>
                  </linearGradient>
                  <linearGradient
                    id="paint3_linear"
                    x1="80554.3"
                    y1="158787"
                    x2="80554.3"
                    y2="28448.4"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#808080" stop-opacity="0.25"></stop>
                    <stop
                      offset="0.54"
                      stop-color="#808080"
                      stop-opacity="0.12"
                    ></stop>
                    <stop
                      offset="1"
                      stop-color="#808080"
                      stop-opacity="0.1"
                    ></stop>
                  </linearGradient>
                  <linearGradient
                    id="paint4_linear"
                    x1="39087.3"
                    y1="2997.36"
                    x2="39087.3"
                    y2="2060.96"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#808080" stop-opacity="0.25"></stop>
                    <stop
                      offset="0.54"
                      stop-color="#808080"
                      stop-opacity="0.12"
                    ></stop>
                    <stop
                      offset="1"
                      stop-color="#808080"
                      stop-opacity="0.1"
                    ></stop>
                  </linearGradient>
                  <linearGradient
                    id="paint5_linear"
                    x1="15402.1"
                    y1="3969.76"
                    x2="15402.1"
                    y2="2661.94"
                    gradientUnits="userSpaceOnUse"
                  >
                    <stop stop-color="#808080" stop-opacity="0.25"></stop>
                    <stop
                      offset="0.54"
                      stop-color="#808080"
                      stop-opacity="0.12"
                    ></stop>
                    <stop
                      offset="1"
                      stop-color="#808080"
                      stop-opacity="0.1"
                    ></stop>
                  </linearGradient>
                  <clipPath id="clip0">
                    <rect width="328" height="299" fill="white"></rect>
                  </clipPath>
                </defs>
              </svg>
            </div>
            <p>Tiada Pesanan Lepas</p>
          </div>';

// Ensure user_id exists in the session
if (isset($_GET['idpelanggan'])) {
  $idpelanggan = $_GET['idpelanggan'];

  // Connect to the orders database
  include_once(__DIR__ . '/../connect.php');
  $connOrders = getConnection();

  // Fetch all orders for the logged-in user
  $sql = "SELECT * FROM maklumat_pesanan WHERE idpelanggan = ? ORDER BY tarikh";
  $stmt = $connOrders->prepare($sql);
  $stmt->bind_param("s", $idpelanggan);
  $stmt->execute();
  $result = $stmt->get_result();

  // Initialize data structure
  $current_orders = [];
  $past_orders = [];
  $current_date = date('Y-m-d');

  // Group orders into current and past orders
  while ($row = $result->fetch_assoc()) {
    $order_date = date('Y-m-d', strtotime($row['tarikh']));
    if ($order_date === $current_date) {
      $current_orders[] = $row;
    } else {
      $past_orders[] = $row;
    }
  }

  // Helper function to process and group orders by unique tarikh
  function groupOrdersByDate($orders)
  {
    $orders_by_date = [];
    foreach ($orders as $row) {
      $tarikh = $row['tarikh'];
      if (!isset($orders_by_date[$tarikh])) {
        $orders_by_date[$tarikh] = [];
      }
      $orders_by_date[$tarikh][] = $row;
    }
    return $orders_by_date;
  }

  $current_orders_by_date = groupOrdersByDate($current_orders);
  $past_orders_by_date = groupOrdersByDate($past_orders);

  $total_current_orders = count($current_orders_by_date);
  $total_past_orders = count($past_orders_by_date);

  $stmt->close();
  $connOrders->close();
}
?>

<?php
//! PHP FOR GENERATING FOOD ITEMS
include_once(__DIR__ . '/../connect.php');
$conn = getConnection();

// Handle the AJAX request for fetching order details
if (isset($_GET['tarikh']) && isset($_GET['namapelanggan'])) {
  $tarikh = $_GET['tarikh'];
  $namapelanggan = $_GET['namapelanggan'];

  // Query to fetch orders by exact DATETIME and customer name
  $sql = "
        SELECT t.idmakanan, t.bilangan, t.nota, m.namamakanan, m.harga, m.harga_pembungkusan
        FROM tempahan t
        INNER JOIN makanan m ON t.idmakanan = m.idmakanan
        INNER JOIN pelanggan p ON t.idpelanggan = p.idpelanggan
        WHERE t.tarikh = ? AND p.namapelanggan = ?
    ";

  $stmt = $conn->prepare($sql);
  $stmt->bind_param("ss", $tarikh, $namapelanggan);
  $stmt->execute();
  $result = $stmt->get_result();

  $orderDetails = [];

  while ($row = $result->fetch_assoc()) {
    $orderDetails[] = [
      'namamakanan' => $row['namamakanan'],
      'harga' => $row['harga'],
      'harga_pembungkusan' => $row['harga_pembungkusan'],
      'bilangan' => $row['bilangan'],
      'nota' => $row['nota'],
    ];
  }

  // Return data as JSON
  echo json_encode($orderDetails);
  exit();  // Make sure to stop execution here
}
?>

<?php
//! PHP FOR UPDATING ORDER STATUS
include_once(__DIR__ . '/../connect.php');
$conn = getConnection();

// Handle AJAX requests
if ($_SERVER["REQUEST_METHOD"] == "POST" && isset($_POST['action'])) {
  $action = $_POST['action'];
  $namapelanggan = $_POST['namapelanggan'];
  $tarikh = $_POST['tarikh'];

  try {
    // Get idpelanggan
    $stmt = $conn->prepare("SELECT idpelanggan FROM pelanggan WHERE namapelanggan = ?");
    $stmt->bind_param("s", $namapelanggan);
    $stmt->execute();
    $result = $stmt->get_result()->fetch_assoc();

    if ($result) {
      $idpelanggan = $result['idpelanggan'];

      // Update the status in the maklumat_pesanan table
      $stmt = $conn->prepare("UPDATE maklumat_pesanan SET status_pesanan = ? WHERE idpelanggan = ? AND tarikh = ?");
      $stmt->bind_param("sss", $action, $idpelanggan, $tarikh);
      $stmt->execute();

      echo json_encode(['success' => true, 'message' => 'Order status updated successfully.']);
    } else {
      echo json_encode(['success' => false, 'message' => 'Customer not found.']);
    }
  } catch (Exception $e) {
    echo json_encode(['success' => false, 'message' => 'Database error: ' . $e->getMessage()]);
  }
  exit;
}
?>

<?php
//! GET ALL THE COLUMNS FROM pelanggan TABLE BASED ON THE idpelanggan
if (isset($_GET['idpelanggan'])) {
  $idpelanggan = $_GET['idpelanggan'];

  include_once(__DIR__ . '/../connect.php');
  $conn = getConnection();

  $sql = "SELECT * FROM pelanggan WHERE idpelanggan = ?";
  $stmt = $conn->prepare($sql);

  if ($stmt) {
    $stmt->bind_param("s", $idpelanggan);
    $stmt->execute();
    $result = $stmt->get_result();

    if ($result->num_rows > 0) {
      $row = $result->fetch_assoc();
      $namapelanggan = $row['namapelanggan'];
      $nohp = $row['nohp'];
      $email_pelanggan = $row['email_pelanggan'];
      $alamat_pelanggan = $row['alamat_pelanggan'];
    } else {
      echo "No pelanggan found with the provided ID.";
    }

    $stmt->close();
  } else {
    echo "Query preparation failed: " . $conn->error;
  }

  $conn->close();
} else {
  echo "ID Pelanggan is missing from the URL.";
}
?>

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <!-- Important to make website responsive-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contour Cafe'</title>

  <!--Barlow fonts-->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Barlow:wght@400;500;600;700&display=swap"
    rel="stylesheet" />

  <!--Link the CSS file-->
  <link rel="stylesheet" href="../css/menu.css" />
  <link rel="stylesheet" href="../css/general.css" />
  <link rel="stylesheet" href="../css/basket-items.css" />
  <link rel="stylesheet" href="../css/modal-food-preview.css" />
  <link rel="stylesheet" href="../css/scrollbar.css" />
  <link rel="stylesheet" href="../css/user-order.css" />
  <link rel="stylesheet" href="css/admin-manage-order.css" />
  <link rel="stylesheet" href="css/admin-order-report.css" />
  <link rel="stylesheet" href="../css/mobile-navigation.css" />
  <link rel="stylesheet" href="css/admin-mobile-navigation-bar.css" />
  <link rel="icon" type="image/jpg" href="../Logo image/Contour Cafe’.jpg" />

  <!--Link the icons file-->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
</head>

<body id="body">
  <!--Navigation bar starts here-->
  <header>
    <div class="main-header">
      <!--Middle section starts here-->
      <div class="middle-section">
        <!--Logo section-->
        <a class="logo-link" href="admin-index.php">
          <img
            class="contour-cafe-logo"
            src="../Logo image/Contour Cafe’.jpg"
            alt="" />
        </a>
        <!--Links section-->
        <nav class="links-section">
          <ul id="ul-header" class="ul-header"></ul>
        </nav>

        <!-- Mobile version menu button -->
        <button class="navbar-toggler" id="navbar-toggler">
          <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="undefined">
            <path d="M120-240v-80h720v80H120Zm0-200v-80h720v80H120Zm0-200v-80h720v80H120Z" />
          </svg>
        </button>

      </div>
      <!--Middle section ends here-->
    </div>
  </header>
  <!--Navigation bar ends here-->

  <!-- Mobile version nav bar starts here! -->
  <div class="nav-bar-mobile">
    <div>
      <button class="nav-bar-mobile-close-button">
        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="undefined">
          <path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z" />
        </svg>
      </button>
    </div>
    <nav class="nav-bar-mobile-links-section">
      <ul id="js-ul__mobile" class="ul__mobile"></ul>
    </nav>
  </div>
  <!-- Mobile version nav bar ends here! -->

  <!-- Main content starts here! -->
  <div id="printable-area">
    <main class="main">
      <div class="main-content-container">
        <div class="main-content">
          <div class="user-details-container">
            <div>
              <a href="admin-manage-user.php">
                <img src="icons/popup-back-icon.svg" alt="">
              </a>
              <p style="text-decoration: underline;">
                Butiran Pengguna
              </p>
            </div>
            <span>Nama: <?= $_GET['namapelanggan'] ?></span>
            <span>E-mel: <?= $email_pelanggan ?></span>
            <span>Nombor Telefon: <?= $nohp ?></span>
            <span>Alamat: <?= $alamat_pelanggan ?></span>
          </div>
          <div class="main-content-title">
            <button class="display-current-order-button js-display-current-order-button">Pesanan Semasa</button>
            <button class="display-past-order-button js-display-past-order-button">Pesanan Lepas</button>
          </div>

          <!-- Current Orders Section -->
          <div class="orders-display-container" id="currentOrders">
            <p class="total-orders">Jumlah Pesanan: <?php echo $total_current_orders ?></p>
            <?php if (empty($current_orders_by_date)): ?>
              <?php echo $past_orders_content; ?>
            <?php else: ?>
              <ol>
                <?php foreach ($current_orders_by_date as $tarikh => $orders): ?>

                  <?php
                  foreach ($orders as $order) {
                    $total_items = $order['jumlah_item'];
                    $order_status = $order['status_pesanan'];
                    $notes = $order['nota_pesanan'];
                    $subtotal = $order['subtotal'];
                    $tax = $order['tax'];
                    $total = $order['total'];
                  }

                  $formatted_time = date('h:i:s A', strtotime($tarikh));
                  ?>

                  <li>
                    <div class="order-date-group">
                      <div>
                        <div class="order-date">Tarikh Pesanan: <?php echo date('Y-m-d', strtotime($tarikh)) . " " . $formatted_time; ?></div>
                        <p class="order-quantity">
                          Jumlah Item: <?php echo $total_items; ?>
                        </p>
                        <p class="order-quantity">
                          Nota Pesanan: <?= $notes; ?>
                        </p>
                      </div>
                      <div class="order-status-and-lihat-button-container">
                        <p class="order-status">Status:
                          <span id="js-order-status-text-<?php echo $tarikh; ?>" class="order-status-text js-order-status-text-<?php echo $tarikh; ?>"><?php echo $order_status; ?></span>
                        </p>
                        <button
                          class="lihat-order-button js-lihat-order-button-<?php echo $tarikh; ?>"
                          data-order-id="<?php echo $tarikh; ?>"
                          onclick="
                          submitOrder('<?php echo $tarikh; ?>', '<?= $namapelanggan ?>');
                          ChangeOrderStatusButton('<?php echo $tarikh; ?>');
                        ">
                          Lihat
                        </button>
                      </div>
                    </div>

                    <!-- Hidden Form -->
                    <form id="orderForm" method="POST" style="display:none;">
                      <input type="hidden" name="tarikh" id="tarikh">
                    </form>

                    <dialog class="order-dialog food-preview-modal" id="js-order-dialog-<?php echo $tarikh; ?>">
                      <!--First Vertical Layout-->
                      <div class='modal-title-and-close-button'>
                        <div class='change-order-status-buttons-container'>
                          <button
                            class='ready-button'
                            data-button-id='<?php echo $tarikh; ?>'
                            id='ready-button-<?php echo $tarikh; ?>'
                            onclick='
                            changeReadyButtonColor(`<?php echo $tarikh; ?>`);
                            updateStatus(`Ready`, `<?php echo $namapelanggan; ?>`, `<?php echo $tarikh; ?>`)
                        '>
                            Ready
                          </button>
                          <button
                            class='pending-button'
                            data-button-id='<?php echo $tarikh; ?>'
                            id='pending-button-<?php echo $tarikh; ?>'
                            onclick='changePendingButtonColor(`<?php echo $tarikh; ?>`);
                          updateStatus(`Pending`, `<?php echo $namapelanggan; ?>`, `<?php echo $tarikh; ?>`)
                        '>
                            Pending
                          </button>
                          <button
                            class='cancel-button'
                            data-button-id='<?php echo $tarikh; ?>'
                            id='cancel-button-<?php echo $tarikh; ?>'
                            onclick='changeCancelButtonColor(`<?php echo $tarikh; ?>`);
                          updateStatus(`Cancelled`, `<?php echo $namapelanggan; ?>`, `<?php echo $tarikh; ?>`)
                        '>
                            Cancel
                          </button>
                        </div>

                        <button
                          class='
                        close-button-food-preview-modal 
                        js-close-order-dialog-button'
                          data-order-id='<?php echo $tarikh; ?>
                      '
                          onclick='
                        closeOrderDialog(`<?php echo $tarikh; ?>`);
                        resetButtonsOrderStatusColor(`<?php echo $tarikh; ?>`);
                      '>
                          x
                        </button>
                      </div>

                      <div class="modal-scrollable-content">
                        <p class="restaurant-name">Contour Cafe'</p>
                        <div class="order-details">
                          <div class="order-date">Tarikh Pesanan: <?php echo date('Y-m-d', strtotime($tarikh)) . " " . $formatted_time; ?></div>
                          <p>Item:</p>
                        </div>
                        <div id="order-items-container-<?php echo $tarikh; ?>" class="order-items-container">

                        </div>
                        <div
                          id="checkout-summary-details"
                          class="checkout-summary-details">
                          <div class="details-top">
                            <div class="basket-subtotal-and-price">
                              <strong>Jumlah kecil</strong>
                              <strong
                                id="subtotal-basket-<?php echo $tarikh; ?>" class="total">
                                <?= $subtotal; ?>
                              </strong>
                            </div>

                            <div id="basket-tax-and-price" class="basket-tax-and-price">
                              <strong>SST(6%)</strong>
                              <strong id="tax-basket-<?php echo $tarikh; ?>" class="total">
                                <?= $tax; ?>
                              </strong>
                            </div>
                          </div>

                          <div class="basket-total-and-price">
                            <strong>Jumlah</strong>
                            <strong
                              id="total-price-basket-<?php echo $tarikh; ?>"
                              class="total">
                              <?= $total; ?>
                            </strong>
                          </div>
                        </div>
                      </div>
                      <div class="modal-closing-text">
                        <p>Terima Kasih! Sila datang lagi!</p>
                      </div>
                    </dialog>
                  </li>

                <?php endforeach; ?>
              </ol>
            <?php endif; ?>
          </div>

          <!-- Past Orders Section -->
          <div class="orders-display-container" id="pastOrders" style="display: none;">
            <p class="total-orders">Jumlah Pesanan: <?php echo $total_past_orders ?></p>
            <?php if (empty($past_orders_by_date)): ?>
              <?php echo $past_orders_content; ?>
            <?php else: ?>
              <ol>
                <?php foreach ($past_orders_by_date as $tarikh => $orders): ?>

                  <?php
                  foreach ($orders as $order) {
                    $total_items = $order['jumlah_item'];
                    $order_status = $order['status_pesanan'];
                    $notes = $order['nota_pesanan'];
                    $subtotal = $order['subtotal'];
                    $tax = $order['tax'];
                    $total = $order['total'];
                  }

                  $formatted_time = date('h:i:s A', strtotime($tarikh));
                  ?>

                  <li>
                    <div class="order-date-group">
                      <div>
                        <div class="order-date">Tarikh Pesanan: <?php echo date('Y-m-d', strtotime($tarikh)) . " " . $formatted_time; ?></div>
                        <p class="order-quantity">
                          Jumlah Item: <?php echo $total_items; ?>
                        </p>
                        <p class="order-quantity">
                          Nota Pesanan: <?= $notes; ?>
                        </p>
                      </div>
                      <div class="order-status-and-lihat-button-container">
                        <p class="order-status">Status:
                          <span id="js-order-status-text-<?php echo $tarikh; ?>" class="order-status-text js-order-status-text-<?php echo $tarikh; ?>"><?php echo $order_status; ?></span>
                        </p>
                        <button
                          class="lihat-order-button js-lihat-order-button-<?php echo $tarikh; ?>"
                          data-order-id="<?php echo $tarikh; ?>"
                          onclick="
                          submitOrder('<?php echo $tarikh; ?>', '<?= $namapelanggan ?>');
                          ChangeOrderStatusButton('<?php echo $tarikh; ?>');
                        ">
                          Lihat
                        </button>
                      </div>
                    </div>

                    <!-- Hidden Form -->
                    <form id="orderForm" method="POST" style="display:none;">
                      <input type="hidden" name="tarikh" id="tarikh">
                    </form>

                    <dialog class="order-dialog food-preview-modal" id="js-order-dialog-<?php echo $tarikh; ?>">
                      <!--First Vertical Layout-->
                      <div class='modal-title-and-close-button'>
                        <div class='change-order-status-buttons-container'>
                          <button
                            class='ready-button'
                            data-button-id='<?php echo $tarikh; ?>'
                            id='ready-button-<?php echo $tarikh; ?>'
                            onclick='
                            changeReadyButtonColor(`<?php echo $tarikh; ?>`);
                            updateStatus(`Ready`, `<?php echo $namapelanggan; ?>`, `<?php echo $tarikh; ?>`)
                        '>
                            Ready
                          </button>
                          <button
                            class='pending-button'
                            data-button-id='<?php echo $tarikh; ?>'
                            id='pending-button-<?php echo $tarikh; ?>'
                            onclick='changePendingButtonColor(`<?php echo $tarikh; ?>`);
                          updateStatus(`Pending`, `<?php echo $namapelanggan; ?>`, `<?php echo $tarikh; ?>`)
                        '>
                            Pending
                          </button>
                          <button
                            class='cancel-button'
                            data-button-id='<?php echo $tarikh; ?>'
                            id='cancel-button-<?php echo $tarikh; ?>'
                            onclick='changeCancelButtonColor(`<?php echo $tarikh; ?>`);
                          updateStatus(`Cancelled`, `<?php echo $namapelanggan; ?>`, `<?php echo $tarikh; ?>`)
                        '>
                            Cancel
                          </button>
                        </div>
                        <button
                          class="close-button-food-preview-modal js-close-order-dialog-button" data-order-id="<?php echo $tarikh; ?>"
                          onclick="
                        closeOrderDialog(`<?php echo $tarikh; ?>`);
                        resetButtonsOrderStatusColor(`<?php echo $tarikh; ?>`);
                      ">
                          x
                        </button>
                      </div>

                      <div class="modal-scrollable-content">
                        <div>
                          <p class="restaurant-name">Contour Cafe'</p>
                          <div class="order-details">
                            <div class="order-date">Tarikh Pesanan: <?php echo date('Y-m-d', strtotime($tarikh)) . " " . $formatted_time; ?></div>
                            <p>Item:</p>
                          </div>
                          <div id="order-items-container-<?php echo $tarikh; ?>" class="order-items-container">
                            <!-- EMPTY BECAUSE GENERATED FROM JS -->
                          </div>
                        </div>
                        <div
                          id="checkout-summary-details"
                          class="checkout-summary-details">
                          <div class="details-top">
                            <div class="basket-subtotal-and-price">
                              <strong>Jumlah kecil</strong>
                              <strong
                                id="subtotal-basket-<?php echo $tarikh; ?>" class="total">
                                <?= $subtotal; ?>
                              </strong>
                            </div>

                            <div id="basket-tax-and-price" class="basket-tax-and-price">
                              <strong>SST(6%)</strong>
                              <strong id="tax-basket-<?php echo $tarikh; ?>" class="total">
                                <?= $tax; ?>
                              </strong>
                            </div>
                          </div>

                          <div class="basket-total-and-price">
                            <strong>Jumlah</strong>
                            <strong
                              id="total-price-basket-<?php echo $tarikh; ?>"
                              class="total">
                              <?= $total; ?>
                            </strong>
                          </div>
                        </div>
                      </div>
                      <div class="modal-closing-text">
                        <p>Terima Kasih! Sila datang lagi!</p>
                      </div>
                    </dialog>

                  </li>

                <?php endforeach; ?>
              </ol>
            <?php endif; ?>
          </div>
        </div>
        <div class="print-button-container">
          <button class="print-button" onclick="print()">
            <svg class="printer-icon" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 122.88 114.13" style="enable-background:new 0 0 122.88 114.13" xml:space="preserve">
              <g>
                <path d="M23.2,29.44V3.35V0.53C23.2,0.24,23.44,0,23.73,0h2.82h54.99c0.09,0,0.17,0.02,0.24,0.06l1.93,0.8l-0.2,0.49l0.2-0.49 c0.08,0.03,0.14,0.08,0.2,0.14l12.93,12.76l0.84,0.83l-0.37,0.38l0.37-0.38c0.1,0.1,0.16,0.24,0.16,0.38v1.18v13.31 c0,0.29-0.24,0.53-0.53,0.53h-5.61c-0.29,0-0.53-0.24-0.53-0.53v-6.88H79.12H76.3c-0.29,0-0.53-0.24-0.53-0.53 c0-0.02,0-0.03,0-0.05v-2.77h0V6.69H29.89v22.75c0,0.29-0.24,0.53-0.53,0.53h-5.64C23.44,29.97,23.2,29.73,23.2,29.44L23.2,29.44z M30.96,67.85h60.97h0c0.04,0,0.08,0,0.12,0.01c0.83,0.02,1.63,0.19,2.36,0.49c0.79,0.33,1.51,0.81,2.11,1.41 c0.59,0.59,1.07,1.31,1.4,2.1c0.3,0.73,0.47,1.52,0.49,2.35c0.01,0.04,0.01,0.08,0.01,0.12v0v9.24h13.16h0c0.04,0,0.07,0,0.11,0.01 c0.57-0.01,1.13-0.14,1.64-0.35c0.57-0.24,1.08-0.59,1.51-1.02c0.43-0.43,0.78-0.94,1.02-1.51c0.21-0.51,0.34-1.07,0.35-1.65 c-0.01-0.03-0.01-0.07-0.01-0.1v0V43.55v0c0-0.04,0-0.07,0.01-0.11c-0.01-0.57-0.14-1.13-0.35-1.64c-0.24-0.56-0.59-1.08-1.02-1.51 c-0.43-0.43-0.94-0.78-1.51-1.02c-0.51-0.22-1.07-0.34-1.65-0.35c-0.03,0.01-0.07,0.01-0.1,0.01h0H11.31h0 c-0.04,0-0.08,0-0.11-0.01c-0.57,0.01-1.13,0.14-1.64,0.35C9,39.51,8.48,39.86,8.05,40.29c-0.43,0.43-0.78,0.94-1.02,1.51 c-0.21,0.51-0.34,1.07-0.35,1.65c0.01,0.03,0.01,0.07,0.01,0.1v0v35.41v0c0,0.04,0,0.08-0.01,0.11c0.01,0.57,0.14,1.13,0.35,1.64 c0.24,0.57,0.59,1.08,1.02,1.51C8.48,82.65,9,83,9.56,83.24c0.51,0.22,1.07,0.34,1.65,0.35c0.03-0.01,0.07-0.01,0.1-0.01h0h13.16 v-9.24v0c0-0.04,0-0.08,0.01-0.12c0.02-0.83,0.19-1.63,0.49-2.35c0.31-0.76,0.77-1.45,1.33-2.03c0.02-0.03,0.04-0.06,0.07-0.08 c0.59-0.59,1.31-1.07,2.1-1.4c0.73-0.3,1.52-0.47,2.36-0.49C30.87,67.85,30.91,67.85,30.96,67.85L30.96,67.85L30.96,67.85z M98.41,90.27v17.37v0c0,0.04,0,0.08-0.01,0.12c-0.02,0.83-0.19,1.63-0.49,2.36c-0.33,0.79-0.81,1.51-1.41,2.11 c-0.59,0.59-1.31,1.07-2.1,1.4c-0.73,0.3-1.52,0.47-2.35,0.49c-0.04,0.01-0.08,0.01-0.12,0.01h0H30.96h0 c-0.04,0-0.08-0.01-0.12-0.01c-0.83-0.02-1.62-0.19-2.35-0.49c-0.79-0.33-1.5-0.81-2.1-1.4c-0.6-0.6-1.08-1.31-1.41-2.11 c-0.3-0.73-0.47-1.52-0.49-2.35c-0.01-0.04-0.01-0.08-0.01-0.12v0V90.27H11.31h0c-0.04,0-0.08,0-0.12-0.01 c-1.49-0.02-2.91-0.32-4.2-0.85c-1.39-0.57-2.63-1.41-3.67-2.45c-1.04-1.04-1.88-2.28-2.45-3.67c-0.54-1.3-0.84-2.71-0.85-4.2 C0,79.04,0,79,0,78.96v0V43.55v0c0-0.04,0-0.08,0.01-0.12c0.02-1.49,0.32-2.9,0.85-4.2c0.57-1.39,1.41-2.63,2.45-3.67 c1.04-1.04,2.28-1.88,3.67-2.45c1.3-0.54,2.71-0.84,4.2-0.85c0.04-0.01,0.08-0.01,0.12-0.01h0h100.25h0c0.04,0,0.08,0,0.12,0.01 c1.49,0.02,2.91,0.32,4.2,0.85c1.39,0.57,2.63,1.41,3.67,2.45c1.04,1.04,1.88,2.28,2.45,3.67c0.54,1.3,0.84,2.71,0.85,4.2 c0.01,0.04,0.01,0.08,0.01,0.12v0v35.41v0c0,0.04,0,0.08-0.01,0.12c-0.02,1.49-0.32,2.9-0.85,4.2c-0.57,1.39-1.41,2.63-2.45,3.67 c-1.04,1.04-2.28,1.88-3.67,2.45c-1.3,0.54-2.71,0.84-4.2,0.85c-0.04,0.01-0.08,0.01-0.12,0.01h0H98.41L98.41,90.27z M89.47,15.86 l-7-6.91v6.91H89.47L89.47,15.86z M91.72,74.54H31.16v32.89h60.56V74.54L91.72,74.54z" />
              </g>
            </svg>
            Cetak
          </button>
        </div>
      </div>
    </main>
  </div>
  <!-- Main content ends here! -->

  <!--Footer starts here!-->
  <footer>
    <div class="footer">
      <div style="display: flex; justify-content: center">
        <div class="logo-and-socialmedia-icons-div">
          <div>
            <a href="admin-index.php">
              <img
                class="logo-image-footer"
                src="../Logo image/Contour Cafe’.jpg"
                alt="" />
            </a>
          </div>
          <div class="socialmedia-icons-div">
            <div class="socialmedia-icons-subdiv">
              <a
                class="footer-icon-link"
                href="https://www.instagram.com/contour.pj/?hl=en"
                target="_blank">
                <img class="insta-icon" src="icons/insta.svg" alt="" />
              </a>
              <a
                class="footer-icon-link"
                href="https://www.facebook.com/p/ContourPJ-61551751387405/"
                target="_blank">
                <img class="fb-icon" src="icons/fb.svg" alt="" />
              </a>
            </div>
          </div>
        </div>
      </div>

      <hr class="footer-hr" style="width: 1103.6px" />

      <div class="terms-and-conditions-join-us-div">
        <div class="terms-and-conditions-join-us-subdiv">
          <div>
            <p>Sah</p>
            <a href="admin-privacy-policy.html" class="a-footer-link">Dasar Privasi</a>
            <a href="admin-terms-and-conditions.html" class="a-footer-link">Syarat Penggunaan</a>
          </div>
        </div>
      </div>
    </div>
  </footer>
  <!--Footer ends here!-->

  <!--Link the JS file-->
  <script src="data/HeaderLinksDataAdmin.js"></script>
  <script src="js/generateHeaderLinksAdmin.js"></script>
  <script src="js/admin-order-report.js"></script>
  <script src="data/mobileHeaderLinksDataAdmin.js"></script>
  <script src="js/generateMobileHeaderLinksAdmin.js"></script>
  <script src="js/admin-mobile-navigation-bar.js"></script>

  <script>
    // Display food items when 'Lihat' button is clicked
    async function submitOrder(tarikh, namapelanggan) {
      // Use fetch to make a GET request to the server for the selected 'tarikh' and 'namapelanggan'
      const response = await fetch(window.location.href + `&tarikh=${encodeURIComponent(tarikh)}`);
      const orderDetails = await response.json(); // Parse the JSON response

      let html = '';

      if (orderDetails.length > 0) {
        html += `<ol class="modal-item-ol">`;

        let subTotal = 0;
        let tax = 0;

        orderDetails.forEach(order => {
          const harga = parseFloat(order.harga.replace('RM', '').trim());
          const totalPrice = harga * order.bilangan;
          const takeAwayPrice = (parseFloat(order.harga_pembungkusan.replace('RM', '').trim()) * order.bilangan).toFixed(2);
          html += `
              <li class="modal-item-li">
                <div class="modal-item-container">
                  <div class="modal-item-container-left">
                    <div>
                      <p class="modal-item-food-name">${order.namamakanan}</p>
                      <p class="modal-item-price">(RM ${harga.toFixed(2)})</p>
                      <p class="modal-item-quantity">x${order.bilangan}</p>
                    </div>
                    <div>
                      <p class="modal-item-notes">
                        Nota: ${order.nota}
                      </p>
                    </div>
                  </div>
                  <div class="modal-item-container-right">
                    <div>
                      <p class="modal-item-total-price">
                        Harga: <strong>RM${totalPrice.toFixed(2)}</strong>
                      </p>
                    </div>
                    <div>
                      <p>
                        Harga Pembungkusan: <strong>RM${takeAwayPrice}</strong>
                      </p>
                    </div>
                  </div>
                </div>
              </li>
          `;
        });

        html += `</ol>`;
      } else {
        html = '<p>No items found for the selected order.</p>';
      }

      document.getElementById(`order-items-container-${tarikh}`).innerHTML = html;
    }

    // Function to update order status
    function updateStatus(action, namapelanggan, tarikh) {
      const data = new FormData();
      data.append('action', action);
      data.append('namapelanggan', namapelanggan);
      data.append('tarikh', tarikh);

      fetch('', { // Send the request to the same PHP file
          method: 'POST',
          body: data
        })
        .then(response => response.json())
        .then(data => {
          if (data.success) {

            location.reload(); // Reload page to reflect updated status
          } else {
            alert('Error: ' + data.message);
          }
        })
        .catch(error => {
          console.error('Error:', error);
        });
    }

    // function printContent() {
    //   let printableArea = document.getElementById("printable-area").innerHTML;
    //   let orginalContent = document.body.innerHTML;

    //   document.body.innerHTML = printableArea;

    //   window.print();

    //   document.body.innerHTML = orginalContent;
    // }
  </script>
</body>

</html>